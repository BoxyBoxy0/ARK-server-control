<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>ARK Server Control</title>
    <style>
        :root{
          --bg:#0f1720;
          --card:#0b1220;
          --muted:#9aa6b2;
          --accent:#2b6cb0;
          --button:#1f2937;
          --button-hover:#323f4a;
          --border:#22313f;
        }

        html,body{height:100%}
        body {
          font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
          max-width: 820px;
          margin: 40px auto;
          background: linear-gradient(180deg,#06121a 0%, #071923 100%);
          color:#e6eef6;
          padding: 28px;
        }

        .container {
          background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
          border: 2px solid var(--border);
          border-radius: 12px;
          padding: 22px;
          box-shadow: 0 8px 30px rgba(2,6,23,0.6);
        }

        h1{margin-top:0; font-size:28px; letter-spacing:0.2px; color:#f5fbff}
        p{color:var(--muted)}
        #backend{font-weight:600;color:#cfe7ff;}

        .controls {margin: 16px 0;}
        button {
          padding: 10px 16px;
          margin-right: 10px;
          border-radius: 8px;
          border: 2px solid var(--border);
          background: var(--button);
          color: #eaf3ff;
          font-weight:700;
          cursor:pointer;
          box-shadow: 0 4px 8px rgba(0,0,0,0.45);
          transition: transform .08s ease, background .12s ease, box-shadow .12s ease;
        }
        button:hover{ background:var(--button-hover); transform: translateY(-1px);}
        button:active{ transform:translateY(0); box-shadow: 0 2px 6px rgba(0,0,0,0.5); }
        button:focus{ outline: 3px solid rgba(43,108,176,0.16); outline-offset:3px; }

        code { background: #07111a; padding: 4px 8px; border-radius:8px; color:#cfe7ff; border:1px solid var(--border); font-weight:600; }
        pre {
          background: linear-gradient(180deg,#07111a,#0b1622);
          padding: 14px;
          border-radius: 10px;
          overflow:auto;
          border: 2px solid var(--border);
          color:#d5e8ff;
          font-weight:600;
          box-shadow: inset 0 1px 0 rgba(255,255,255,0.02);
        }

        @media (max-width:520px){
          body{margin:18px}
          button{display:block;margin:8px 0;width:100%;}
        }
      </style>
  </head>
<body>
  <h1>ARK Server Control</h1>

  <p><b>Backend:</b> <span id="backendUrl"></span></p>

  <button onclick="restartServer()">Restart</button>
  <button onclick="startServer()">Start</button>
  <button onclick="stopServer()">Stop</button>
  <button onclick="checkStatus()">Status</button>

  <h3>Output</h3>
  <pre id="out">Ready.</pre>

  <script>
    const BACKEND = "YOUR_NGROK_URL_HERE"; // e.g. https://finniest-fransisca-ureido.ngrok-free.dev
    const TOKEN = "ark-panel-9f3k2lq8";    // better later: login; for now this is ok

    document.getElementById("backendUrl").textContent = BACKEND;

    function show(obj) {
      document.getElementById("out").textContent =
        (typeof obj === "string") ? obj : JSON.stringify(obj, null, 2);
    }

    async function api(path, method="GET") {
      const res = await fetch(`${BACKEND}${path}`, {
        method,
        headers: {
          "x-control-token": TOKEN
        }
      });

      // Read text first so we can debug HTML errors
      const text = await res.text();
      let json;
      try {
        json = JSON.parse(text);
      } catch (e) {
        throw new Error(`Non-JSON response (${res.status}): ${text.slice(0, 120)}...`);
      }
      return json;
    }

    async function restartServer() {
      try { show(await api("/api/restart", "POST")); }
      catch (e) { show("Restart failed: " + e.message); }
    }

    async function startServer() {
      try { show(await api("/api/start", "POST")); }
      catch (e) { show("Start failed: " + e.message); }
    }

    async function stopServer() {
      try { show(await api("/api/stop", "POST")); }
      catch (e) { show("Stop failed: " + e.message); }
    }

    async function checkStatus() {
      try { show(await api("/api/status", "GET")); }
      catch (e) { show("Status failed: " + e.message); }
    }
  </script>
</body>
</html>
